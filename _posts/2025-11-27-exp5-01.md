---
layout: default
title: 分析素数
---

{% include posts/ReAlgorithm.html title="判断素数" %}

# 题目解释

给定一个数$n$，写一个函数，判定这个数是不是素数。

# 思路解析

## 素数定义

素数: 因数只有1和本身的数。

合数: 除了1和本身还有别的因数的数。

## 基本思想

穷尽所有特殊情况，随后使用迭代处理大部分的情况

使用迭代或者递归，遍历1到给定数n范围内的所有数，如果有一个数可以被给定数整除，那么这个数就不是素数，反之，则是。


**算法时间复杂度关键点**

> 迭代次数

## 初步实现算法

一个素数，首先一定是一个奇数 ($2$除外) ，这意味着我们只需要检查奇数因子即可。
> 除2以外，偶数一定不是素数。

## 优化算法

如何减少迭代次数? 等价于 如何缩小因数的范围?

简单做一个数学推导。

对给定一个数$n$，不妨设其是合数。即是说$n=a \times b$。且必有$1 < a \le b < n$。

不妨设$a>\sqrt{n}，b>\sqrt{n}$，则是说$a\times b>n$，与$n=a\times b$不符。

故此$a\le \sqrt{n}$或者$b\le\sqrt{n}$至少有一个成立。

即是说，对于任意一个合数$n$，必有一个因子$a$，小于$\sqrt{n}$。

至此，我们优化了迭代的次数到$\sqrt{n}$。

# 实现算法

## 分类讨论

```cpp
int isP(int num)
{
    if (num <= 1)
    {
        // todoing
    }
    else if (num == 2)
    {
        // todoing
    }
    else if (num % 2 == 0)
    {
        // todoing
    }
    else
    {
        // todoing
    }
    return -1;
}
```

这里我们分了如下几种情况。
- 小于等于$1$
  - 定义为$D_1$
  - 此部分包含了$0$，$1$，以及负数。这一部分都不是素数。
- $2$
  - 定义为$D_2$
  - 特殊情况，$2$是素数。
- 正偶数(除$2$外)
  - 定义为$D_3$
  - 偶数都不是素数
- 除此之外的数
  - 定义为$D_4$
  - 对于除此之外的数，我们需要使用迭代遍历区间内部的所有数，来判断是否存在一个数是他的因子。

值得注意的是，我们的函数在各个情况下，均闭合(有各自的`return`语句)，但是我依然在函数的最后添加了一个返回`-1`的函数，用于报错。

> 这里涉及的是分类讨论的最基本的定义，此处不在赘述，对笔者而言，分支语句，妙处就在这里。

## $D_4$实现

现在我们来写最后一个部分的遍历函数，我们首先使用迭代来实现这个效果。

基于上面部分的分析，我们知道我们需要遍历的范围是在$1$到$\sqrt{n}$之间。而在上面的分类中，我们知道，这部分的数，均是奇数，所以我们自然不用遍历任何偶数。

> 偶数与偶数相乘，结果一定是偶数

随后我们再次分析我们的遍历数集，$1$没有价值，任何数都有因数$1$，所以我们的遍历应该从$1$后的第一个奇数开始，即是$3$。

自此我们获得了数集$D_5$，我们注意到，$D_5 \in D_4$，这是符合常理的。

现在我们确认了迭代的写法，现在在来确定迭代的内容。**如果有因数，就不是素数**。这句话就是迭代的内容。所以如果有了因子，那么就返回假，如果遍历结束还是没有，那就说明是素数，则返回真。

依照如上的逻辑，写出了如下的代码。

```cpp
for (int i = 3; i < sqrt(num); i++)
{
    if (num % i == 0)
    {
        return 0;
    }
}
return 1;
```

至此，这个函数就已经写完了，值得注意的是，由于在`c`中没有`bool`值，所以我们使用的是返回值`int`类型，实际上这个类型也比`bool`值好用一些。

# 完整代码

```cpp
#include <math.h>
#include <stdio.h>

int isP(int num)
{
    if (num <= 1)
    {
        return 0;
    }
    else if (num == 2)
    {
        return 1;
    }
    else if (num % 2 == 0)
    {
        return 0;
    }
    else
    {
        for (int i = 3; i < sqrt(num); i++)
        {
            if (num % i == 0)
            {
                return 0;
            }
        }
        return 1;
    }
    return -1;
}
```